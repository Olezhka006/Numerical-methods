def l1(points, x):
    x0, y0 = points[0]
    x1, y1 = points[1]
    L0 = (x - x1) / (x0 - x1)
    L1 = (x - x0) / (x1 - x0)
    return y0 * L0 + y1 * L1

def l2(points, x):
    x0, y0 = points[0]
    x1, y1 = points[1]
    x2, y2 = points[2]
    L0 = ((x - x1) * (x - x2)) / ((x0 - x1) * (x0 - x2))
    L1 = ((x - x0) * (x - x2)) / ((x1 - x0) * (x1 - x2))
    L2 = ((x - x0) * (x - x1)) / ((x2 - x0) * (x2 - x1))
    return y0 * L0 + y1 * L1 + y2 * L2

def n1(x, y, tt, st):
    h = x[1] - x[0]
    t = (tt - x[0]) / h
    if st == 1:
        delta_y0 = y[1] - y[0]
        return y[0] + t * delta_y0
    elif st == 2:
        delta_y0 = y[1] - y[0]
        delta_y1 = y[2] - y[1]
        delta2_y0 = delta_y1 - delta_y0
        result = y[0] + t * delta_y0 + (t * (t - 1) / 2) * delta2_y0
        return result

def n2(x, y, tt, st):
    h = x[1] - x[0]
    t = (tt - x[-1]) / h 
    if st == 1:
        delta_yn1 = y[-1] - y[-2]  
        return y[-1] + t * delta_yn1
    elif st == 2:
        delta_yn1 = y[-1] - y[-2] 
        delta_yn2 = y[-2] - y[-3]  
        delta2_yn2 = delta_yn1 - delta_yn2  
        result = y[-1] + t * delta_yn1 + (t * (t + 1) / 2) * delta2_yn2
        return result

print("ТЕМА 4. ИНТЕРПОЛИРОВАНИЕ И ЭКСТРАПОЛИРОВАНИЕ".center(50))
print("ФУНКЦИЙ. ПРАКТИЧЕСКОЕ ЗАНЯТИЕ.".center(50))
print("СОСТАВЛЕНИЕ ИНТЕРПОЛЯЦИОННЫХ ФОРМУЛ".center(50))
print("ЛАГРАНЖА, НЬЮТОНА.".center(50))
print("=" * 50)
n = 13
x1 = int((40 - 1.33 * n)) * 0.01
print(f"x1 = int(40 - 1.33 * n) * 0.01 = {x1:.4f}")  
x2 = int((80 + 1.57 * n)) * 0.01 
print(f"x2 = int(80 + 1.57 * n) * 0.01 = {x2:.4f}")   
x3 = int((180 - 1.15 * n)) * 0.01 
print(f"x3 = int(180 - 1.15 * n) * 0.01 = {x3:.4f}")
x = [0, 0.2, 0.4, 0.6, 0.8, 1, 1.2, 1.4, 1.6, 1.8]
y = [1, 1.099, 1.0780, 1.1708, 1.2937, 1.4427, 1.6144, 1.8061, 2.0161, 2.2429]

print("\nТАБЛИЦА ЗНАЧЕНИЙ ФУНКЦИИ:")
print("x:  0.0   0.2   0.4   0.6   0.8   1.0   1.2   1.4   1.6   1.8")
print("y:  1.000 1.099 1.078 1.171 1.294 1.443 1.614 1.806 2.016 2.243")

print("\n" + "=" * 50)
print("ЛАГРАНЖ".center(50))
print("=" * 50)

points_x1_1 = [[x[1], y[1]], [x[2], y[2]]]  
points_x1_2 = [[x[0], y[0]], [x[1], y[1]], [x[2], y[2]]]  
points_x2_1 = [[x[4], y[4]], [x[5], y[5]]]  
points_x2_2 = [[x[4], y[4]], [x[5], y[5]], [x[6], y[6]]] 
points_x3_1 = [[x[8], y[8]], [x[9], y[9]]]  
points_x3_2 = [[x[7], y[7]], [x[8], y[8]], [x[9], y[9]]] 

print(f"\nЛагранж 1 степени x1 = {l1(points_x1_1, x1):.4f}")
print("Таблица для x1 (1 степень):")
print("x:  0.2   0.4")
print("y:  1.099 1.078")

print(f"\nЛагранж 2 степени x1 = {l2(points_x1_2, x1):.4f}")
print("Таблица для x1 (2 степень):")
print("x:  0.0   0.2   0.4")
print("y:  1.000 1.099 1.078")

print(f"\nЛагранж 1 степени x2 = {l1(points_x2_1, x2):.4f}")
print("Таблица для x2 (1 степень):")
print("x:  0.8   1.0")
print("y:  1.294 1.443")

print(f"\nЛагранж 2 степени x2 = {l2(points_x2_2, x2):.4f}")
print("Таблица для x2 (2 степень):")
print("x:  0.8   1.0   1.2")
print("y:  1.294 1.443 1.614")

print(f"\nЛагранж 1 степени x3 = {l1(points_x3_1, x3):.4f}")
print("Таблица для x3 (1 степень):")
print("x:  1.6   1.8")
print("y:  2.016 2.243")

print(f"\nЛагранж 2 степени x3 = {l2(points_x3_2, x3):.4f}")
print("Таблица для x3 (2 степень):")
print("x:  1.4   1.6   1.8")
print("y:  1.806 2.016 2.243")

print("\n" + "=" * 50)
print("НЬЮТОН".center(50))
print("=" * 50)
print("Таблица разностей")
print("x     y       Δy      Δ²y")
print("-" * 30)
print("0.0   1.0000  0.0990  -0.1200")
print("0.2   1.0990  -0.0210  0.1138")
print("0.4   1.0780  0.0928   0.0301")
print("0.6   1.1708  0.1229   0.0261")
print("0.8   1.2937  0.1490   0.0227")
print("1.0   1.4427  0.1717   0.0200")
print("1.2   1.6144  0.1917   0.0183")
print("1.4   1.8061  0.2100   0.0168")
print("1.6   2.0161  0.2268")
print("1.8   2.2429")

x_x1 = [x[1], x[2]]  
y_x1 = [y[1], y[2]]  
print(f"\nНьютон 1 степени x1 = {n1(x_x1, y_x1, x1, 1):.4f}")
print("Таблица для x1 (1 степень):")
print("x    y      Δy")
print("0.2  1.099  -0.021")
print("0.4  1.078")

x_x1_2 = [x[0], x[1], x[2]]  
y_x1_2 = [y[0], y[1], y[2]]  
print(f"\nНьютон 2 степени x1 = {n1(x_x1_2, y_x1_2, x1, 2):.4f}")
print("Таблица для x1 (2 степень):")
print("x    y      Δy     Δ²y")
print("0.0  1.000  0.099  -0.120")
print("0.2  1.099  -0.021")
print("0.4  1.078")

x_x2 = [x[4], x[5]]  
y_x2 = [y[4], y[5]]  
print(f"\nНьютон 1 степени x2 = {n1(x_x2, y_x2, x2, 1):.4f}")
print("Таблица для x2 (1 степень):")
print("x    y      Δy")
print("0.8  1.294  0.149")
print("1.0  1.443")

x_x2_2 = [x[4], x[5], x[6]]  
y_x2_2 = [y[4], y[5], y[6]]  
print(f"\nНьютон 2 степени x2 = {n1(x_x2_2, y_x2_2, x2, 2):.4f}")
print("Таблица для x2 (2 степень):")
print("x    y      Δy     Δ²y")
print("0.8  1.294  0.149  0.0227")
print("1.0  1.443  0.1717")
print("1.2  1.614")

x_x3 = [x[8], x[9]]  
y_x3 = [y[8], y[9]]  
print(f"\nНьютон 1 степени x3 = {n2(x_x3, y_x3, x3, 1):.4f}")
print("Таблица для x3 (1 степень):")
print("x    y      Δy")
print("1.6  2.016  0.227")
print("1.8  2.243")

x_x3_2 = [x[7], x[8], x[9]]  
y_x3_2 = [y[7], y[8], y[9]]  
print(f"\nНьютон 2 степени x3 = {n2(x_x3_2, y_x3_2, x3, 2):.4f}")
print("Таблица для x3 (2 степень):")
print("x    y      Δy     Δ²y")
print("1.4  1.806  0.210  0.0168")
print("1.6  2.016  0.2268")
print("1.8  2.243")

print("\n" + "=" * 50)
print("ОБЩИЙ РЕЗУЛЬТАТ".center(50))
print("=" * 50)

print("Точка      Лагранж 1ст  Лагранж 2ст  Ньютон 1ст  Ньютон 2ст")
print("x1=0.2200  " + f"{l1(points_x1_1, x1):.4f}      {l2(points_x1_2, x1):.4f}      {n1(x_x1, y_x1, x1, 1):.4f}      {n1(x_x1_2, y_x1_2, x1, 2):.4f}")
print("x2=1.0000  " + f"{l1(points_x2_1, x2):.4f}      {l2(points_x2_2, x2):.4f}      {n1(x_x2, y_x2, x2, 1):.4f}      {n1(x_x2_2, y_x2_2, x2, 2):.4f}")
print("x3=1.6500  " + f"{l1(points_x3_1, x3):.4f}      {l2(points_x3_2, x3):.4f}      {n2(x_x3, y_x3, x3, 1):.4f}      {n2(x_x3_2, y_x3_2, x3, 2):.4f}")

input()